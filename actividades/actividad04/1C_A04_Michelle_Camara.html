<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Conversiones - N√∫meros Complejos</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Lexend+Deca:wght@100..900&family=Playwrite+GB+J:ital,wght@0,100..400;1,100..400&display=swap" rel="stylesheet" rel="stylesheet">

    <style>
        /* ==================== RESET B√ÅSICO ==================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        /* ==================== ESTRUCTURA GENERAL ==================== */
        body {
            font-family:"Lexend Deca", sans-serif;
            background-color: #fdfcf9;
            color: #39190F;
            padding: 20px;
            line-height: 1.6;
            font-size: 16px;

        }
        .container {
            max-width: 950 px;
            background-color: #fffaf5;
            border: 3px solid #d8b99b;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 6px 6px 0 #b08968;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* ==================== ENCABEZADOS ==================== */
    .banner{
            text-align: center;
            margin-bottom: 20px;
    }  
    .h1{
        font-family: "Playwrite GB J", cursive;
        align-items: center;
        text-align: center;
        font-size: 26px;
        color: #6f4e37;
        background: #f3e5d0;
        display: inline-block;
        padding: 12px 25px;
        border-radius: 15px;
        border: 2px dashed #b08968;
        box-shadow: 2px 2px 0 #a47551;
    }
    h1{
        animation-duration: 3s;
        animation-name: slidein;
        animation-direction: normal;
        animation-iteration-count: 1;
        animation-timing-function: ease-out;
        display: block;
        margin-left: auto;
        margin-right: auto;
        text-align: center;
    }
    @keyframes slidein {
        from {
        margin-left: auto;
        margin-right: auto;
        transform: translateX(-100%);
        width: 300%;
        }
        to {
        margin-left: auto;
        margin-right: auto;
        transform: translateX(0%);
        width: 100%;
        }
    }

    .meta{
            margin-top: 8px;
            font-size: 14px;
            color: #8c5c42;
            animation-duration: 3s;
            animation-name: slidein;
            animation-direction: normal;
            animation-iteration-count: 1;
            animation-timing-function: ease-out;
    }

    .instructions{
            background-color: #f7ede2;
            border: 2px solid #e3c9b1;
            padding: 15px;
            border-radius: 8px;
            font-size: 14px;
            color: #5c4033;
            overflow: hidden;
            white-space: nowrap;
            border-right: 2px solid #a47551;
            animation: blink-caret 0.7s step-end 7;
            animation-fill-mode: forwards;
    }

    @keyframes blink-caret {
        from, to { border-color: transparent }
        50% { border-color: #a47551; }
    }
    .instructions strong{
            color: #a47551;
            font-size: 16px;
    }
    .instructions ul{
            margin-top: 8px;
            list-style-type: disc;
            padding-left: 20px;
    }
    .form-section{
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
            background-color: #fffdf9;
            border: 2px solid #e3c9b1;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 3px 3px 0 #d1a280;
            display: flex;
            flex-direction: column;
            gap: 15px;

            /* Animaci√≥n de aparici√≥n */
            opacity: 0;
            animation: fadein 1.2s ease-in forwards;
    }

    @keyframes fadein {
        from { opacity: 0; }
        to   { opacity: 1; }
    }

    .form-section h2{
            font-size: 16px;
            margin-bottom: 12px;
            color: #6f4e37;
            border-bottom: 1px dashed #d8b99b;
            padding-bottom: 5px;
    }

    .input-group{
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 8px;
            font-size: 15px;
            color: #5c4033;  
    }
    input[type="text"] {
            flex: 1;
            min-width: 90px;
            padding: 8px 10px;
            border: 2px solid #d8b99b;
            border-radius: 8px;
            background: #fdfaf6;
            font-family: "Courier New", monospace;
            text-align: center;
            color: #39190F;
    }
    input[type="text"]:focus {
            outline: none;
            border-color: #a47551;
            box-shadow: inset 2px 2px 0 #d8b99b;
    }
    .operator {
            font-weight: bold;
            color: #8c5c42;
    }
    .result {
            margin-top: auto;
            background: #e5cbcc;
            padding: 10px;
            border-radius: 10px;
            font-family: "Courier New", monospace;
            font-size: 14px;
            color: #39190F;
            font-weight: bold;
            border-left: 6px solid #6f4e37;
            box-shadow: inset 2px 2px 0 #d1a280;
    }
    .clear-btn {
            background: #d1a280;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 30px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 3px 3px 0 #a47551;
            display: block;
            margin-left: auto;
            margin-right: auto;
            opacity: 0;
            animation: fadein 4s ease-in forwards;
    }
    .clear-btn:hover {
            background: #6f4e37;
            box-shadow: 2px 2px 0 #39190F;
    }
    .clear-btn:active {
            box-shadow: none;
            transform: translateY(2px);
    }
    @media (max-width: 600px) {
        .form-section {
            grid-template-columns: 1fr;
        }
    }
        /* ==================== FIN DE ESTILOS ==================== */
    </style>
    
</head>
<body>
    <div class="container">
        <h1>Calculadora de Conversiones de N√∫meros Complejos</h1>
        <div class= "banner">
        <p class="meta">Tecnol√≥gico de Software ¬∑ Fundamentos de √Ålgebra ¬∑ Prof. Jorge Javier Pedrozo Romero ¬∑ 1¬∞C ¬∑ Cuatrimestre 1 ¬∑ Michelle C√°mara Gonz√°lez</p></div>
        <div class="instructions">
            <strong>‚ú¶ Instrucciones: </strong>
            <ul>
                <li>Ingresa un n√∫mero complejo en cualquiera de las tres formas</li>
                <li>Las otras formas se calcular√°n autom√°ticamente</li>
                <li>Los √°ngulos se expresan en radianes y en m√∫ltiplos de pi cuando es posible</li>
                <li>Para √°ngulos puedes usar: pi, pi/2, pi/4, pi/3, pi/6, 2*pi, etc.</li>
                <li>Para ra√≠ces cuadradas puedes usar: sqrt(2), sqrt(3), sqrt(5), etc.</li>
                <li>Usa n√∫meros decimales (ejemplo: 1.5, -2.7, 0.5)</li>
            </ul>
        </div>
        <!-- Forma Cartesiana -->
        <div class="form-section">
            <h2>üç™ Forma Cartesiana: a + bi</h2>
            <div class="input-group">
                <label>z =</label>
                <input type="text" id="real" placeholder="a (ej: sqrt(2))">
                <span class="operator">+</span>
                <input type="text" id="imag" placeholder="b (ej: sqrt(3))">
                <span class="operator">i</span>
            </div>
            <div class="result" id="cartesian-result">Ingresa los valores arriba</div>
        </div>
        <!-- Forma Polar -->
        <div class="form-section">
            <h2>üçµ Forma Polar: r(cos Œ∏ + i sin Œ∏)</h2>
            <div class="input-group">
                <label>z =</label>
                <input type="text" id="modulus" placeholder="r (ej: sqrt(2))">
                <span class="operator">(cos</span>
                <input type="text" id="angle" placeholder="Œ∏ (ej: pi/2)">
                <span class="operator">+ i sin</span>
                <input type="text" id="angle2" placeholder="Œ∏" readonly>
                <span class="operator">)</span>
            </div>
            <div class="result" id="polar-result">Ingresa los valores arriba</div>
        </div>
        <!-- Forma Exponencial -->
        <div class="form-section">
            <h2>üç∞ Forma Exponencial: re^(iŒ∏)</h2>
            <div class="input-group">
                <label>z =</label>
                <input type="text" id="exp-modulus" placeholder="r (ej: sqrt(5))">
                <span class="operator">e^(i*</span>
                <input type="text" id="exp-angle" placeholder="Œ∏ (ej: pi/4)">
                <span class="operator">)</span>
            </div>
            <div class="result" id="exponential-result">Ingresa los valores arriba</div>
        </div>
        <button class="clear-btn" onclick="clearAll()">üç™ Limpiar Todo</button>
    </div>
</body>
<script>
  
// ============================================================================
// VARIABLES GLOBALES
// ============================================================================

let isUpdating = false; // Previene bucles infinitos durante actualizaciones

// ============================================================================
// FUNCIONES DE PARSEO
// ============================================================================

/**
 * Convierte una cadena de texto a n√∫mero, soportando expresiones matem√°ticas
 * @param {string|number} input - Entrada del usuario
 * @returns {number} - Resultado num√©rico
 */
function parseNumber(input) {
    // Manejar casos vac√≠os o nulos
    if (!input && input !== 0) return 0;
    
    const inputStr = input.toString().trim();
    if (!inputStr) return 0;
    
    // Preparar expresi√≥n reemplazando funciones matem√°ticas
    let expression = inputStr
        .replace(/sqrt\s*\(/gi, 'Math.sqrt(')  // sqrt(2) ‚Üí Math.sqrt(2)
        .replace(/pi\b/gi, 'Math.PI');         // pi ‚Üí Math.PI
    
    try {
        // Evaluar expresi√≥n de forma segura
        const result = Function('"use strict"; return (' + expression + ')')();
        
        // Verificar que el resultado sea v√°lido
        if (isNaN(result) || !isFinite(result)) {
            return 0;
        }
        
        return result;
    } catch (error) {
        // En caso de error, retornar 0
        return 0;
    }
}

/**
 * Convierte una cadena de texto a √°ngulo en radianes
 * @param {string|number} input - Entrada del usuario
 * @returns {number} - √Ångulo en radianes
 */
function parseAngle(input) {
    return parseNumber(input); // Usa la misma l√≥gica que parseNumber
}

// ============================================================================
// FUNCIONES DE FORMATO Y VISUALIZACI√ìN
// ============================================================================

/**
 * Convierte un √°ngulo en radianes a su representaci√≥n en m√∫ltiplos de pi
 * @param {number} angle - √Ångulo en radianes
 * @returns {string} - Representaci√≥n en formato pi
 */
function angleToPI(angle) {
    if (Math.abs(angle) < 1e-8) return "0";
    
    // M√∫ltiplos comunes de pi
    const piMultiples = [
        { value: Math.PI, text: "pi" },
        { value: Math.PI/2, text: "pi/2" },
        { value: Math.PI/3, text: "pi/3" },
        { value: Math.PI/4, text: "pi/4" },
        { value: Math.PI/6, text: "pi/6" },
        { value: 2*Math.PI, text: "2*pi" },
        { value: 3*Math.PI/2, text: "3*pi/2" },
        { value: 2*Math.PI/3, text: "2*pi/3" },
        { value: 3*Math.PI/4, text: "3*pi/4" },
        { value: 5*Math.PI/6, text: "5*pi/6" },
        { value: 5*Math.PI/4, text: "5*pi/4" },
        { value: 4*Math.PI/3, text: "4*pi/3" },
        { value: 5*Math.PI/3, text: "5*pi/3" },
        { value: 7*Math.PI/4, text: "7*pi/4" },
        // Valores negativos
        { value: -Math.PI, text: "-pi" },
        { value: -Math.PI/2, text: "-pi/2" },
        { value: -Math.PI/3, text: "-pi/3" },
        { value: -Math.PI/4, text: "-pi/4" },
        { value: -Math.PI/6, text: "-pi/6" },
        { value: -2*Math.PI, text: "-2*pi" },
        { value: -3*Math.PI/2, text: "-3*pi/2" },
        { value: -2*Math.PI/3, text: "-2*pi/3" },
        { value: -3*Math.PI/4, text: "-3*pi/4" },
        { value: -5*Math.PI/6, text: "-5*pi/6" }
    ];

    // Buscar coincidencia exacta
    for (let pm of piMultiples) {
        if (Math.abs(angle - pm.value) < 1e-8) {
            return pm.text;
        }
    }

    // Intentar expresar como fracci√≥n de pi
    const ratio = angle / Math.PI;
    
    // M√∫ltiplo entero de pi
    if (Math.abs(ratio - Math.round(ratio)) < 1e-8) {
        const intRatio = Math.round(ratio);
        if (intRatio === 1) return "pi";
        if (intRatio === -1) return "-pi";
        if (intRatio === 0) return "0";
        return intRatio + "*pi";
    }

    // Fracciones simples de pi
    const denominators = [2, 3, 4, 6, 8, 12];
    for (let den of denominators) {
        const num = ratio * den;
        if (Math.abs(num - Math.round(num)) < 1e-8) {
            const intNum = Math.round(num);
            if (intNum === 0) return "0";
            if (den === 1) {
                return intNum === 1 ? "pi" : intNum === -1 ? "-pi" : intNum + "*pi";
            }
            if (intNum === 1) return "pi/" + den;
            if (intNum === -1) return "-pi/" + den;
            return intNum + "*pi/" + den;
        }
    }

    // Si no se puede expresar como m√∫ltiplo de pi, usar decimal
    return angle.toFixed(6);
}

/**
 * Formatea un n√∫mero mostrando fracciones y ra√≠ces cuando sea posible
 * @param {number} num - N√∫mero a formatear
 * @returns {string} - Representaci√≥n formateada
 */
function formatNumber(num) {
    if (Math.abs(num) < 1e-10) return "0";
    
    // Ra√≠ces cuadradas comunes
    const sqrtValues = [
        { value: Math.sqrt(2), text: "‚àö2" },
        { value: Math.sqrt(3), text: "‚àö3" },
        { value: Math.sqrt(5), text: "‚àö5" },
        { value: Math.sqrt(6), text: "‚àö6" },
        { value: Math.sqrt(7), text: "‚àö7" },
        { value: Math.sqrt(8), text: "2‚àö2" },
        { value: Math.sqrt(12), text: "2‚àö3" },
        { value: Math.sqrt(18), text: "3‚àö2" },
        { value: Math.sqrt(27), text: "3‚àö3" },
        { value: Math.sqrt(2)/2, text: "‚àö2/2" },
        { value: Math.sqrt(3)/2, text: "‚àö3/2" },
        { value: Math.sqrt(3)/3, text: "‚àö3/3" },
        { value: -Math.sqrt(2), text: "-‚àö2" },
        { value: -Math.sqrt(3), text: "-‚àö3" },
        { value: -Math.sqrt(2)/2, text: "-‚àö2/2" },
        { value: -Math.sqrt(3)/2, text: "-‚àö3/2" },
        { value: -Math.sqrt(3)/3, text: "-‚àö3/3" }
    ];

    // Verificar ra√≠ces
    for (let sv of sqrtValues) {
        if (Math.abs(num - sv.value) < 1e-8) {
            return sv.text;
        }
    }

    // Fracciones comunes
    const fractions = [
        { value: 1/2, text: "1/2" },
        { value: 1/3, text: "1/3" },
        { value: 2/3, text: "2/3" },
        { value: 1/4, text: "1/4" },
        { value: 3/4, text: "3/4" },
        { value: 1/6, text: "1/6" },
        { value: 5/6, text: "5/6" },
        { value: 1/8, text: "1/8" },
        { value: 3/8, text: "3/8" },
        { value: 5/8, text: "5/8" },
        { value: 7/8, text: "7/8" },
        { value: -1/2, text: "-1/2" },
        { value: -1/3, text: "-1/3" },
        { value: -2/3, text: "-2/3" },
        { value: -1/4, text: "-1/4" },
        { value: -3/4, text: "-3/4" }
    ];

    // Verificar fracciones
    for (let frac of fractions) {
        if (Math.abs(num - frac.value) < 1e-8) {
            return frac.text;
        }
    }

    // Enteros
    if (Math.abs(num - Math.round(num)) < 1e-8) {
        return Math.round(num).toString();
    }

    // Decimal con precisi√≥n limitada
    return parseFloat(num.toFixed(6)).toString();
}

// ============================================================================
// FUNCIONES MATEM√ÅTICAS AUXILIARES
// ============================================================================

/**
 * Normaliza un √°ngulo al rango (-œÄ, œÄ]
 * @param {number} angle - √Ångulo en radianes
 * @returns {number} - √Ångulo normalizado
 */
function normalizeAngle(angle) {
    while (angle > Math.PI) angle -= 2 * Math.PI;
    while (angle <= -Math.PI) angle += 2 * Math.PI;
    return angle;
}

// ============================================================================
// FUNCIONES DE ACTUALIZACI√ìN
// ============================================================================

/**
 * Actualiza todas las formas cuando se modifica la forma cartesiana
 */
function updateFromCartesian() {
    if (isUpdating) return;
    isUpdating = true;

    // Obtener valores de los campos
    const real = parseNumber(document.getElementById('real').value) || 0;
    const imag = parseNumber(document.getElementById('imag').value) || 0;

    // Calcular m√≥dulo y argumento
    const modulus = Math.sqrt(real * real + imag * imag);
    let angle = Math.atan2(imag, real);
    angle = normalizeAngle(angle);

    // Actualizar forma polar
    const modulusFormatted = formatNumber(modulus);
    const angleFormatted = angleToPI(angle);
    
    document.getElementById('modulus').value = modulusFormatted;
    document.getElementById('angle').value = angleFormatted;
    document.getElementById('angle2').value = angleFormatted;

    // Actualizar forma exponencial
    document.getElementById('exp-modulus').value = modulusFormatted;
    document.getElementById('exp-angle').value = angleFormatted;

    // Actualizar resultados mostrados
    updateResults(real, imag, modulus, angle);

    isUpdating = false;
}

/**
 * Actualiza todas las formas cuando se modifica la forma polar
 */
function updateFromPolar() {
    if (isUpdating) return;
    isUpdating = true;

    // Obtener valores de los campos
    const modulus = parseNumber(document.getElementById('modulus').value) || 0;
    const angle = parseAngle(document.getElementById('angle').value) || 0;
    const normalizedAngle = normalizeAngle(angle);

    // Sincronizar segundo campo de √°ngulo
    const angleFormatted = angleToPI(normalizedAngle);
    document.getElementById('angle2').value = angleFormatted;

    // Calcular coordenadas cartesianas
    const real = modulus * Math.cos(normalizedAngle);
    const imag = modulus * Math.sin(normalizedAngle);

    // Actualizar forma cartesiana
    document.getElementById('real').value = formatNumber(real);
    document.getElementById('imag').value = formatNumber(imag);

    // Actualizar forma exponencial
    document.getElementById('exp-modulus').value = formatNumber(modulus);
    document.getElementById('exp-angle').value = angleFormatted;

    // Actualizar resultados mostrados
    updateResults(real, imag, modulus, normalizedAngle);

    isUpdating = false;
}

/**
 * Actualiza todas las formas cuando se modifica la forma exponencial
 */
function updateFromExponential() {
    if (isUpdating) return;
    isUpdating = true;

    // Obtener valores de los campos
    const modulus = parseNumber(document.getElementById('exp-modulus').value) || 0;
    const angle = parseAngle(document.getElementById('exp-angle').value) || 0;
    const normalizedAngle = normalizeAngle(angle);

    // Calcular coordenadas cartesianas
    const real = modulus * Math.cos(normalizedAngle);
    const imag = modulus * Math.sin(normalizedAngle);

    // Actualizar forma cartesiana
    document.getElementById('real').value = formatNumber(real);
    document.getElementById('imag').value = formatNumber(imag);

    // Actualizar forma polar
    const angleFormatted = angleToPI(normalizedAngle);
    document.getElementById('modulus').value = formatNumber(modulus);
    document.getElementById('angle').value = angleFormatted;
    document.getElementById('angle2').value = angleFormatted;

    // Actualizar resultados mostrados
    updateResults(real, imag, modulus, normalizedAngle);

    isUpdating = false;
}

/**
 * Actualiza los resultados mostrados en todas las secciones
 * @param {number} real - Parte real
 * @param {number} imag - Parte imaginaria  
 * @param {number} modulus - M√≥dulo
 * @param {number} angle - Argumento en radianes
 */
function updateResults(real, imag, modulus, angle) {
    const angleText = angleToPI(angle);
    
    // Resultado cartesiano
    let cartesianText = "";
    if (real !== 0 || imag !== 0) {
        if (real !== 0) {
            cartesianText += formatNumber(real);
        }
        if (imag > 0) {
            cartesianText += (real !== 0 ? " + " : "");
            if (imag === 1) {
                cartesianText += "i";
            } else {
                cartesianText += formatNumber(imag) + "i";
            }
        } else if (imag < 0) {
            cartesianText += " - ";
            if (imag === -1) {
                cartesianText += "i";
            } else {
                cartesianText += formatNumber(-imag) + "i";
            }
        }
        if (cartesianText === "") cartesianText = "0";
    } else {
        cartesianText = "0";
    }
    document.getElementById('cartesian-result').textContent = "z = " + cartesianText;

    // Resultado polar
    let polarText = "";
    if (modulus !== 0) {
        polarText = formatNumber(modulus) + "(cos(" + angleText + ") + i sin(" + angleText + "))";
    } else {
        polarText = "0";
    }
    document.getElementById('polar-result').textContent = "z = " + polarText;

    // Resultado exponencial
    let expText = "";
    if (modulus !== 0) {
        expText = formatNumber(modulus) + "e^(i*" + angleText + ")";
    } else {
        expText = "0";
    }
    document.getElementById('exponential-result').textContent = "z = " + expText;
}

// ============================================================================
// FUNCIONES AUXILIARES
// ============================================================================

/**
 * Limpia todos los campos de entrada y resultados
 */
function clearAll() {
    // Limpiar todos los campos de entrada
    const inputs = document.querySelectorAll('input[type="text"], input[type="number"]');
    inputs.forEach(input => input.value = '');
    
    // Limpiar todos los resultados
    const results = document.querySelectorAll('.result');
    results.forEach(result => result.textContent = 'Ingresa los valores arriba');
}

// ============================================================================
// INICIALIZACI√ìN Y EVENT LISTENERS
// ============================================================================

/**
 * Configura los event listeners cuando el DOM est√° listo
 */
document.addEventListener('DOMContentLoaded', function() {
    // Event listeners para forma cartesiana
    document.getElementById('real').addEventListener('input', updateFromCartesian);
    document.getElementById('imag').addEventListener('input', updateFromCartesian);

    // Event listeners para forma polar
    document.getElementById('modulus').addEventListener('input', updateFromPolar);
    document.getElementById('angle').addEventListener('input', function() {
        document.getElementById('angle2').value = this.value;
        updateFromPolar();
    });

    // Event listeners para forma exponencial
    document.getElementById('exp-modulus').addEventListener('input', updateFromExponential);
    document.getElementById('exp-angle').addEventListener('input', updateFromExponential);
});
</script>
</html>